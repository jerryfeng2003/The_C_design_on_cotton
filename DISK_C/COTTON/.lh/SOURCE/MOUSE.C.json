{
    "sourceFile": "SOURCE/MOUSE.C",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1681364724278,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1681547756126,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,17 +13,17 @@\n         A.mread\r\n         B.newmouse\r\n VERSION: 3.0\r\n ***************************/\r\n-int MouseX; //鼠标位置x\r\n-int MouseY; //鼠标位置y\r\n-int MouseS; //鼠标形状Shape\r\n-int press;  //鼠标按压状�?\r\n+int MouseX; //榧犳爣浣嶇疆x\r\n+int MouseY; //榧犳爣浣嶇疆y\r\n+int MouseS; //榧犳爣褰㈢姸Shape\r\n+int press;  //榧犳爣鎸夊帇鐘舵€?\r\n void *buffer;\r\n union REGS regs;\r\n-int flag = 0; //鼠标画面存在状�?\r\n+int flag = 0; //榧犳爣鐢婚潰瀛樺湪鐘舵€?\r\n \r\n-void mouseinit() //初�?�化\r\n+void mouseinit() //鍒濆?嬪寲\r\n {\r\n     int retcode;\r\n     int xmin, xmax, ymin, ymax, x_max = 625, y_max = 480;\r\n     int size;\r\n@@ -59,18 +59,18 @@\n }\r\n \r\n /*****************************\r\n FUNCTION: mouse\r\n-DESCRIPTION: 画不同形态的鼠标\r\n+DESCRIPTION: 鐢讳笉鍚屽舰鎬佺殑榧犳爣\r\n INPUT: x,y\r\n-RETURN: �?\r\n+RETURN: 鏃?\r\n ******************************/\r\n void mouse(int x, int y)\r\n {\r\n \r\n     switch (MouseS)\r\n     {\r\n-    case 1: //手势鼠标\r\n+    case 1: //鎵嬪娍榧犳爣\r\n     {\r\n         setcolor(WHITE);\r\n         setlinestyle(0, 0, 1);\r\n         line(x - 1, y + 9, x - 1, y + 8);\r\n@@ -109,26 +109,26 @@\n         line(x + 3, y + 15, x + 1, y + 13);\r\n         line(x + 1, y + 13, x - 1, y + 9);\r\n     }\r\n     break;\r\n-    case 2: //光标\r\n+    case 2: //鍏夋爣\r\n     {\r\n         setcolor(DARKGRAY);\r\n         setlinestyle(0, 0, 1);\r\n         line(x + 1, y - 1, x + 9, y - 1);\r\n         line(x + 1, y + 15, x + 9, y + 15);\r\n         line(x + 5, y - 1, x + 5, y + 15);\r\n     }\r\n     break;\r\n-    case 3: //十字\r\n+    case 3: //鍗佸瓧\r\n     {\r\n         setcolor(WHITE);\r\n         setlinestyle(0, 0, 1);\r\n         line(x - 1, y + 7, x + 11, y + 7);\r\n         line(x + 5, y - 1, x + 5, y + 15);\r\n     }\r\n     break;\r\n-    default: //默�?�鼠�?\r\n+    default: //榛樿?ら紶鏍?\r\n     {\r\n         setlinestyle(0, 0, 1);\r\n         setcolor(WHITE);\r\n         line(x, y, x, y + 13);\r\n@@ -160,9 +160,9 @@\n     break;\r\n     }\r\n }\r\n \r\n-/*void mou_pos(int *nx,int *ny,int*nbuttons)//更改鼠标位置\r\n+/*void mou_pos(int *nx,int *ny,int*nbuttons)//鏇存敼榧犳爣浣嶇疆\r\n {\r\n     int x0=*nx,y0=*ny;\r\n \r\n     mread(nx,ny,nbuttons);\r\n@@ -170,9 +170,9 @@\n     save_bk_mou(*nx,*ny);\r\n     drawmous(*nx,*ny);\r\n }\r\n \r\n-void mread(int *nx,int *ny,int*nbuttons)//改坐标不�?\r\n+void mread(int *nx,int *ny,int*nbuttons)//鏀瑰潗鏍囦笉鐢?\r\n {\r\n     int x0=*nx,y0=*ny,buttons0=*nbuttons;\r\n     int xnew,ynew,buttonsnew;\r\n \r\n@@ -196,12 +196,12 @@\n */\r\n \r\n /***************************************\r\n FUNCTION: mread\r\n-DESCRIPTION: 获取新的寄存器信�?\r\n+DESCRIPTION: 鑾峰彇鏂扮殑瀵勫瓨鍣ㄤ俊鎭?\r\n INPUT: nx,ny,nbuttons\r\n-RETURN: �?\r\n-调用�? newmouse\r\n+RETURN: 鏃?\r\n+璋冪敤锛? newmouse\r\n ****************************************/\r\n void mread(int *nx, int *ny, int *nbuttons)\r\n {\r\n     regs.x.ax = 3;\r\n@@ -212,11 +212,11 @@\n }\r\n \r\n /*******************************************\r\n FUNCTION: newmouse\r\n-DESCRIPTION: 鼠标状态发生变化则更新鼠标\r\n+DESCRIPTION: 榧犳爣鐘舵€佸彂鐢熷彉鍖栧垯鏇存柊榧犳爣\r\n INPUT: nx,ny,nbuttons\r\n-RETURN: �?\r\n+RETURN: 鏃?\r\n ********************************************/\r\n void newmouse(int *nx, int *ny, int *nbuttons)\r\n {\r\n     int xn, yn, buttonsn;\r\n@@ -225,29 +225,29 @@\n     *nx = xn;\r\n     *ny = yn;\r\n     *nbuttons = buttonsn;\r\n     if (buttons0 == *nbuttons)\r\n-        *nbuttons = 0; //使得能连�?按键\r\n+        *nbuttons = 0; //浣垮緱鑳借繛缁?鎸夐敭\r\n     if (xn == x0 && yn == y0 && buttonsn == buttons0)\r\n-        return;      //鼠标状态不变则直接返回S\r\n-    clrmous(x0, y0); //说明鼠标状态发生了改变\r\n+        return;      //榧犳爣鐘舵€佷笉鍙樺垯鐩存帴杩斿洖S\r\n+    clrmous(x0, y0); //璇存槑榧犳爣鐘舵€佸彂鐢熶簡鏀瑰彉\r\n     save_bk_mou(*nx, *ny);\r\n     drawmous(*nx, *ny);\r\n }\r\n \r\n-void save_bk_mou(int nx, int ny) //存鼠标背�?\r\n+void save_bk_mou(int nx, int ny) //瀛橀紶鏍囪儗鏅?\r\n {\r\n     int size;\r\n \r\n     size = imagesize(nx - 1, ny - 2, nx + 11, ny + 17);\r\n     buffer = malloc(size);\r\n     if (buffer != NULL)\r\n-        getimage(nx - 1, ny - 2, nx + 11, ny + 17, buffer); //系统内部函数\r\n+        getimage(nx - 1, ny - 2, nx + 11, ny + 17, buffer); //绯荤粺鍐呴儴鍑芥暟\r\n     else\r\n         printf(\"Error\");\r\n }\r\n \r\n-void clrmous(int nx, int ny) //清除鼠标\r\n+void clrmous(int nx, int ny) //娓呴櫎榧犳爣\r\n {\r\n     if (flag == 1)\r\n     {\r\n         setwritemode(XOR_PUT);\r\n@@ -267,24 +267,24 @@\n         flag = 1;\r\n     }\r\n }\r\n \r\n-//如果在�?�中点击，则返回1；在框中�?点击，则返回2；不在�?�中则返�?0\r\n+//濡傛灉鍦ㄦ?嗕腑鐐瑰嚮锛屽垯杩斿洖1锛涘湪妗嗕腑鏈?鐐瑰嚮锛屽垯杩斿洖2锛涗笉鍦ㄦ?嗕腑鍒欒繑鍥?0\r\n int mouse_press(int x1, int y1, int x2, int y2)\r\n {\r\n-    //在�?�中点击，则返回1\r\n+    //鍦ㄦ?嗕腑鐐瑰嚮锛屽垯杩斿洖1\r\n     if (MouseX > x1 && MouseX < x2 && MouseY > y1 && MouseY < y2 && press == 1)\r\n     {\r\n         return 1;\r\n     }\r\n \r\n-    //在�?�中�?点击，则返回2\r\n+    //鍦ㄦ?嗕腑鏈?鐐瑰嚮锛屽垯杩斿洖2\r\n     else if (MouseX > x1 && MouseX < x2 && MouseY > y1 && MouseY < y2 && press == 0)\r\n     {\r\n         return 2;\r\n     }\r\n \r\n-    //在�?�中点击右键，则返回3\r\n+    //鍦ㄦ?嗕腑鐐瑰嚮鍙抽敭锛屽垯杩斿洖3\r\n     else if (MouseX > x1 && MouseX < x2 && MouseY > y1 && MouseY < y2 && press == 2)\r\n     {\r\n         return 3;\r\n     }\r\n"
                },
                {
                    "date": 1681726760867,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n union REGS regs;\r\n int flag=0;\r\n \r\n \r\n-void mouseinit()//��ʼ��\r\n+void mouseinit()//初始化\r\n {\r\n \tint retcode;\r\n \tint xmin,xmax,ymin,ymax,x_max=625,y_max=480;\r\n \tint size;\r\n@@ -61,18 +61,18 @@\n }\r\n \r\n /*****************************\r\n FUNCTION: mouse\r\n-DESCRIPTION: ����ͬ��̬�����\r\n+DESCRIPTION: 画不同形态的鼠标\r\n INPUT: x,y\r\n-RETURN: ��\r\n+RETURN: 无\r\n ******************************/\r\n void mouse(int x,int y)\r\n {\r\n \t\r\n \tswitch(MouseS)\r\n \t{\r\n-\t\tcase 1:                                  //�������\r\n+\t\tcase 1:                                  //手势鼠标\r\n \t\t{\r\n \t\t\t\tsetcolor(WHITE);\r\n \t\t\t\tsetlinestyle(0,0,1);\r\n \t\t\t\tline(x-1,y+9,x-1,y+8);\r\n@@ -111,26 +111,26 @@\n \t\t\t\tline(x+3,y+15,x+1,y+13);\r\n \t\t\t\tline(x+1,y+13,x-1,y+9);\r\n \t\t}\r\n \t\t\tbreak;\r\n-\t\tcase 2:                        //���\r\n+\t\tcase 2:                        //光标\r\n \t\t{\r\n \t\t\tsetcolor(DARKGRAY);\r\n \t\t\tsetlinestyle(0,0,1);\r\n \t\t\tline(x+1,y-1,x+9,y-1);\r\n \t\t\tline(x+1,y+15,x+9,y+15);\r\n \t\t\tline(x+5,y-1,x+5,y+15);\r\n \t\t}\r\n \t\t\tbreak;\r\n-\t\tcase 3:                        //ʮ��\r\n+\t\tcase 3:                        //十字\r\n \t\t{\r\n \t\t\tsetcolor(WHITE);\r\n \t\t\tsetlinestyle(0,0,1);\r\n \t\t\tline(x-1,y+7,x+11,y+7);\r\n \t\t\tline(x+5,y-1,x+5,y+15);\r\n \t\t}\r\n \t\t\tbreak;\r\n-\t\tdefault:              //Ĭ�����\r\n+\t\tdefault:              //默认鼠标\r\n \t\t{\r\n \t\t\tsetlinestyle(0,0,1);\r\n \t\t\tsetcolor(WHITE);\r\n \t\t\tline(x,y,x,y+13);\r\n@@ -162,9 +162,9 @@\n \t\tbreak;\r\n \t}\r\n }\r\n \r\n-void mou_pos(int *nx,int *ny,int*nbuttons)//�������λ��\r\n+void mou_pos(int *nx,int *ny,int*nbuttons)//更改鼠标位置\r\n {\r\n \tint x0=*nx,y0=*ny;\r\n \r\n \tmread(nx,ny,nbuttons);\r\n@@ -172,9 +172,9 @@\n \tsave_bk_mou(*nx,*ny);\r\n \tdrawmous(*nx,*ny);\r\n }\r\n \r\n-/*void mread(int *nx,int *ny,int*nbuttons)//�����겻��\r\n+/*void mread(int *nx,int *ny,int*nbuttons)//改坐标不画\r\n {\r\n \tint x0=*nx,y0=*ny,buttons0=*nbuttons;\r\n \tint xnew,ynew,buttonsnew;\r\n \r\n@@ -198,11 +198,11 @@\n */\r\n \r\n /***************************************\r\n FUNCTION: mread\r\n-DESCRIPTION: ��ȡ�µļĴ�����Ϣ\r\n+DESCRIPTION: 获取新的寄存器信息\r\n INPUT: nx,ny,nbuttons\r\n-RETURN: ��\r\n+RETURN: 无\r\n ****************************************/\r\n void mread(int *nx,int *ny,int *nbuttons)  \r\n {\r\n \tregs.x.ax=3;\r\n@@ -213,11 +213,11 @@\n }\r\n \r\n /*******************************************\r\n FUNCTION: newmouse\r\n-DESCRIPTION: ���״̬�����仯��������\r\n+DESCRIPTION: 鼠标状态发生变化则更新鼠标\r\n INPUT: nx,ny,nbuttons\r\n-RETURN: ��\r\n+RETURN: 无\r\n ********************************************/\r\n void newmouse(int *nx,int *ny,int *nbuttons)\r\n {\r\n \tint xn,yn,buttonsn;\r\n@@ -226,17 +226,17 @@\n \t*nx = xn;\r\n \t*ny = yn;\r\n \t*nbuttons = buttonsn;\r\n \tif(buttons0 == *nbuttons)\r\n-\t\t*nbuttons = 0;    //ʹ������������\r\n+\t\t*nbuttons = 0;    //使得能连续按键\r\n \tif(xn == x0 && yn == y0 && buttonsn == buttons0)\r\n-\t\treturn;            //���״̬������ֱ�ӷ���S\r\n-\tclrmous(x0,y0);        //˵�����״̬�����˸ı�\r\n+\t\treturn;            //鼠标状态不变则直接返回S\r\n+\tclrmous(x0,y0);        //说明鼠标状态发生了改变\r\n \tsave_bk_mou(*nx,*ny);\r\n \tdrawmous(*nx,*ny);\r\n }\r\n \r\n-void save_bk_mou(int nx,int ny)//����걳��\r\n+void save_bk_mou(int nx,int ny)//存鼠标背景\r\n {\r\n \tint size;\r\n \r\n \tsize=imagesize(nx-1,ny-2,nx+11,ny+17);\r\n@@ -246,9 +246,9 @@\n \telse\r\n \t\tprintf(\"Error\");\r\n }\r\n \r\n-void clrmous(int nx,int ny)//������\r\n+void clrmous(int nx,int ny)//清除鼠标\r\n {\r\n \tif(flag==1)\r\n \t{\r\n \t\tsetwritemode(XOR_PUT); \r\n@@ -270,12 +270,12 @@\n }\r\n \r\n \r\n \r\n-//����ڿ��е�����򷵻�1���ڿ���δ������򷵻�2�����ڿ����򷵻�0\r\n+//如果在框中点击，则返回1；在框中未点击，则返回2；不在框中则返回0\r\n int mouse_press(int x1, int y1, int x2, int y2)\r\n {\r\n-\t//�ڿ��е�����򷵻�1\r\n+\t//在框中点击，则返回1\r\n \tif(MouseX > x1 \r\n \t&&MouseX < x2\r\n \t&&MouseY > y1\r\n \t&&MouseY < y2\r\n@@ -283,9 +283,9 @@\n \t{\r\n \t\treturn 1;\r\n \t}\r\n \t\r\n-\t//�ڿ���δ������򷵻�2\r\n+\t//在框中未点击，则返回2\r\n \telse if(MouseX > x1 \r\n \t&&MouseX < x2\r\n \t&&MouseY > y1\r\n \t&&MouseY < y2\r\n@@ -293,9 +293,9 @@\n \t{\r\n \t\treturn 2;\r\n \t}\r\n \t\r\n-\t//�ڿ��е���Ҽ����򷵻�3\r\n+\t//在框中点击右键，则返回3\r\n \telse if(MouseX > x1 \r\n \t&&MouseX < x2\r\n \t&&MouseY > y1\r\n \t&&MouseY < y2\r\n"
                }
            ],
            "date": 1681364724278,
            "name": "Commit-0",
            "content": "#include<conio.h>\r\n#include<graphics.h>\r\n#include<dos.h>\r\n#include<stdio.h>\r\n#include<stdlib.h>\r\n#include \"mouse.h\"\r\n\r\n\r\n/**************************\r\nMOUSE.c\r\nUPDATER: dengshuumin\r\nFUNCTION: mouse action\r\nABSTRACT:\r\n\t\tA.mread\r\n\t\tB.newmouse\r\nVERSION: 3.0\r\n***************************/\r\nint MouseX;\r\nint MouseY;\r\nint MouseS;\r\nint press;\r\nvoid *buffer;\r\nunion REGS regs;\r\nint flag=0;\r\n\r\n\r\n\r\nvoid mouseinit()//閿熸枻鎷峰閿熸枻鎷?\r\n{\r\n\tint retcode;\r\n\tint xmin,xmax,ymin,ymax,x_max=625,y_max=480;\r\n\tint size;\r\n\r\n\txmin=2;\r\n\txmax=x_max-1;\r\n\tymin=8;\r\n\tymax=y_max-2;\r\n\tregs.x.ax=0;\r\n\tint86(51,&regs,&regs);\r\n\tretcode=regs.x.ax;\r\n\tif(retcode==0)\r\n\t{\r\n\t\tprintf(\"Mouse or Mouse Driver Obsent,Please Install!\");\r\n\t\tdelay(5000);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tregs.x.ax=7;\r\n\t\tregs.x.cx=xmin;\r\n\t\tregs.x.dx=xmax;\r\n\t\tint86(51,&regs,&regs);\r\n\t\tregs.x.ax=8;\r\n\t\tregs.x.cx=ymin;\r\n\t\tregs.x.dx=ymax;\r\n\t\tint86(51,&regs,&regs);\r\n\t}\r\n\tMouseS = 0;\r\n\tMouseX=320,MouseY=240;\r\n\tsave_bk_mou(320,240);\r\n\tmouse(MouseX,MouseY);\r\n\tflag=1;\r\n}\r\n\r\n/*****************************\r\nFUNCTION: mouse\r\nDESCRIPTION: 閿熸枻鎷烽敓鏂ゆ嫹鍚岄敓鏂ゆ嫹鎬侀敓鏂ゆ嫹閿熸枻鎷烽敓?\r\nINPUT: x,y\r\nRETURN: 閿熸枻鎷?\r\n******************************/\r\nvoid mouse(int x,int y)\r\n{\r\n\t\r\n\tswitch(MouseS)\r\n\t{\r\n\t\tcase 1:                                  //閿熸枻鎷烽敓鏂ゆ嫹閿熸枻鎷烽敓?\r\n\t\t{\r\n\t\t\t\tsetcolor(WHITE);\r\n\t\t\t\tsetlinestyle(0,0,1);\r\n\t\t\t\tline(x-1,y+9,x-1,y+8);\r\n\t\t\t\tline(x,y+7,x,y+11);\r\n\t\t\t\tline(x+1,y+6,x+1,y+13);\r\n\t\t\t\tline(x+2,y+8,x+2,y+14);\r\n\t\t\t\tline(x+3,y-1,x+3,y+15);\r\n\t\t\t\tarc(x+4,y-1,0,180,1);\r\n\t\t\t\tline(x+4,y-2,x+4,y+15);\r\n\t\t\t\tline(x+5,y-1,x+5,y+16);\r\n\t\t\t\tarc(x+6,y+3,0,180,1);\r\n\t\t\t\tline(x+6,y+2,x+6,y+16);\r\n\t\t\t\tline(x+7,y+3,x+7,y+17);\r\n\t\t\t\tarc(x+8,y+5,0,180,1);\r\n\t\t\t\tline(x+8,y+4,x+8,y+17);\r\n\t\t\t\tline(x+9,y+5,x+9,y+16);\r\n\t\t\t\tarc(x+10,y+7,0,180,1);\r\n\t\t\t\tline(x+10,y+6,x+10,y+16);\r\n\t\t\t\tline(x+11,y+7,x+11,y+13);\r\n\r\n\t\t\t\tsetcolor(DARKGRAY);\r\n\t\t\t\tline(x-1,y+9,x-1,y+8);\r\n\t\t\t\tline(x-1,y+8,x+1,y+6);\r\n\t\t\t\tline(x+1,y+6,x+3,y+10);\r\n\t\t\t\tline(x+3,y+10,x+3,y-1);\r\n\t\t\t\tarc(x+4,y-1,0,180,1);\r\n\t\t\t\tline(x+5,y-1,x+5,y+5);\r\n\t\t\t\tarc(x+6,y+3,0,180,1);\r\n\t\t\t\tline(x+7,y+3,x+7,y+7);\r\n\t\t\t\tarc(x+8,y+5,0,180,1);\r\n\t\t\t\tline(x+9,y+5,x+9,y+9);\r\n\t\t\t\tarc(x+10,y+7,0,180,1);\r\n\t\t\t\tline(x+11,y+7,x+11,y+13);\r\n\t\t\t\tarc(x+7,y+13,-90,0,4);\r\n\t\t\t\tline(x+7,y+17,x+3,y+15);\r\n\t\t\t\tline(x+3,y+15,x+1,y+13);\r\n\t\t\t\tline(x+1,y+13,x-1,y+9);\r\n\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 2:                        //閿熸枻鎷烽敓?\r\n\t\t{\r\n\t\t\tsetcolor(DARKGRAY);\r\n\t\t\tsetlinestyle(0,0,1);\r\n\t\t\tline(x+1,y-1,x+9,y-1);\r\n\t\t\tline(x+1,y+15,x+9,y+15);\r\n\t\t\tline(x+5,y-1,x+5,y+15);\r\n\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 3:                        //鍗侀敓鏂ゆ嫹\r\n\t\t{\r\n\t\t\tsetcolor(WHITE);\r\n\t\t\tsetlinestyle(0,0,1);\r\n\t\t\tline(x-1,y+7,x+11,y+7);\r\n\t\t\tline(x+5,y-1,x+5,y+15);\r\n\t\t}\r\n\t\t\tbreak;\r\n\t\tdefault:              //榛橀敓鏂ゆ嫹閿熸枻鎷烽敓?\r\n\t\t{\r\n\t\t\tsetlinestyle(0,0,1);\r\n\t\t\tsetcolor(WHITE);\r\n\t\t\tline(x,y,x,y+13);\r\n\t\t\tline(x+1,y+1,x+1,y+12);\r\n\t\t\tline(x+2,y+2,x+2,y+11);\r\n\t\t\tline(x+3,y+3,x+3,y+10);\r\n\t\t\tline(x+4,y+4,x+4,y+12);\r\n\t\t\tline(x+5,y+5,x+5,y+9);\r\n\t\t\tline(x+5,y+11,x+5,y+14);\r\n\t\t\tline(x+6,y+6,x+6,y+9);\r\n\t\t\tline(x+6,y+13,x+6,y+15);\r\n\t\t\tline(x+7,y+7,x+7,y+9);\r\n\t\t\tline(x+8,y+8,x+8,y+9);\r\n\t\t\tline(x+9,y+9,x+9,y+9);\r\n\t\t\tsetcolor(DARKGRAY);\r\n\t\t\tline(x-1,y-1,x-1,y+14);\r\n\t\t\tline(x-1,y+14,x+3,y+11);\r\n\t\t\tline(x+3,y+11,x+3,y+12);\r\n\t\t\tline(x+3,y+12,x+4,y+13);\r\n\t\t\tline(x+4,y+13,x+4,y+14);\r\n\t\t\tline(x+4,y+14,x+7,y+17);\r\n\t\t\tline(x+7,y+17,x+7,y+13);\r\n\t\t\tline(x+7,y+13,x+6,y+12);\r\n\t\t\tline(x+6,y+12,x+6,y+11);\r\n\t\t\tline(x+6,y+11,x+5,y+10);\r\n\t\t\tline(x+5,y+10,x+11,y+10);\r\n\t\t\tline(x+11,y+10,x-1,y-2);\r\n\t\t}\r\n\t\tbreak;\r\n\t}\r\n}\r\n\r\n/*void mou_pos(int *nx,int *ny,int*nbuttons)//閿熸枻鎷烽敓鏂ゆ嫹閿熸枻鎷烽敓杞夸紮鎷烽敓?\r\n{\r\n\tint x0=*nx,y0=*ny;\r\n\r\n\tmread(nx,ny,nbuttons);\r\n\tclrmous(x0,y0);\r\n\tsave_bk_mou(*nx,*ny);\r\n\tdrawmous(*nx,*ny);\r\n}\r\n\r\nvoid mread(int *nx,int *ny,int*nbuttons)//閿熸枻鎷烽敓鏂ゆ嫹閿熺枼涓嶉敓鏂ゆ嫹\r\n{\r\n\tint x0=*nx,y0=*ny,buttons0=*nbuttons;\r\n\tint xnew,ynew,buttonsnew;\r\n\r\n\tdo{\r\n\tregs.x.ax=3;\r\n\tint86(51,&regs,&regs);\r\n\tbuttonsnew=regs.x.bx;\r\n\tdelay(10);\r\n\tregs.x.ax=3;\r\n\tint86(51,&regs,&regs);\r\n\tif(regs.x.bx==buttonsnew)\r\n\t\t*nbuttons=regs.x.bx;\r\n\telse\r\n\t\t*nbuttons=buttons0;\r\n\txnew=regs.x.cx;\r\n\tynew=regs.x.dx;\r\n\t}while(xnew==x0&&ynew==y0&&*nbuttons==0);\r\n\t*nx=xnew;\r\n\t*ny=ynew;\r\n}\r\n*/\r\n\r\n/***************************************\r\nFUNCTION: mread\r\nDESCRIPTION: 閿熸枻鎷峰彇閿熼摪鐨勫瘎杈炬嫹閿熸枻鎷烽敓鏂ゆ嫹鎭?\r\nINPUT: nx,ny,nbuttons\r\nRETURN: 閿熸枻鎷?\r\n****************************************/\r\nvoid mread(int *nx,int *ny,int *nbuttons)  \r\n{\r\n\tregs.x.ax=3;\r\n\tint86(51,&regs,&regs);\r\n\t*nx = regs.x.cx;\r\n\t*ny = regs.x.dx;\r\n\t*nbuttons = regs.x.bx;\r\n}\r\n\r\n/*******************************************\r\nFUNCTION: newmouse\r\nDESCRIPTION: 閿熸枻鎷烽敓闃跺埡顒婃嫹閿熸枻鎷烽敓鏂ゆ嫹娴狀垽鎷烽敓鏂ゆ嫹閿熸枻鎷烽敓鏂ゆ嫹閿??\r\nINPUT: nx,ny,nbuttons\r\nRETURN: 閿熸枻鎷?\r\n********************************************/\r\nvoid newmouse(int *nx,int *ny,int *nbuttons)\r\n{\r\n\tint xn,yn,buttonsn;\r\n\tint x0=*nx,y0=*ny,buttons0=*nbuttons;\r\n\t// if(x0>615)\r\n\t// {\r\n\t// \tclrmous(x0,y0);\r\n\t// }\r\n\tmread(&xn,&yn,&buttonsn);\r\n\t*nx = xn;\r\n\t*ny = yn;\r\n\t*nbuttons = buttonsn;\r\n\tif(buttons0 == *nbuttons)\r\n\t\t*nbuttons = 0;    //浣块敓鏂ゆ嫹閿熸枻鎷烽敓鏂ゆ嫹閿熸枻鎷烽敓鏂ゆ嫹閿熸枻鎷?\r\n\tif(xn == x0 && yn == y0 && buttonsn == buttons0)\r\n\t\treturn;            //閿熸枻鎷烽敓闃跺埡顒婃嫹閿熸枻鎷烽敓鏂ゆ嫹閿熻鎲嬫嫹鑷冮敓鏂ゆ嫹閿熺祳\r\n\tclrmous(x0,y0);        //璇撮敓鏂ゆ嫹閿熸枻鎷烽敓闃跺埡顒婃嫹閿熸枻鎷烽敓鏂ゆ嫹鐑佽皨閿??\r\n\tsave_bk_mou(*nx,*ny);\r\n\tdrawmous(*nx,*ny);\r\n}\r\n\r\nvoid save_bk_mou(int nx,int ny)//閿熸枻鎷烽敓鏂ゆ嫹鐡鎷烽敓?\r\n{\r\n\tint size;\r\n\r\n\tsize=imagesize(nx-1,ny-2,nx+11,ny+17);\r\n\tbuffer=malloc(size);\r\n\tif(buffer!=NULL)\r\n\t\tgetimage(nx-1,ny-2,nx+11,ny+17,buffer);\r\n\telse\r\n\t\tprintf(\"Error\");\r\n}\r\n\r\nvoid clrmous(int nx,int ny)//閿熸枻鎷烽敓鏂ゆ嫹閿熸枻鎷?\r\n{\r\n\tif(flag==1)\r\n\t{\r\n\t\tsetwritemode(XOR_PUT); \r\n\t\tmouse(nx,ny);\r\n\t\tputimage(nx-1,ny-2,buffer,COPY_PUT);\r\n\t\tfree(buffer);\r\n\t\tflag=0;\r\n\t\tsetwritemode(COPY_PUT);\r\n\t}\r\n}\r\nvoid drawmous(int nx,int ny)\r\n{\r\n\tif(flag==0)\r\n\t{\r\n\t\tsetwritemode(COPY_PUT);\r\n\t    mouse(nx,ny);\r\n\t\tflag=1;\r\n\t}\r\n}\r\n\r\n\r\n\r\n//閿熸枻鎷烽敓鏂ゆ嫹璇抽敓鏂ゆ嫹姊伴敓鏂ゆ嫹閿熸枻鎷烽敓娲ヨ繑浼欐嫹1閿熸枻鎷烽敓鑺傚尅鎷烽敓鏂ゆ嫹鏈敓鏂ゆ嫹閿熸枻鎷烽敓鏂ゆ嫹铓嶇シ閿??2閿熸枻鎷烽敓鏂ゆ嫹閿熻妭鍖℃嫹閿熸枻鎷烽敓娲ヨ繑浼欐嫹0\r\nint mouse_press(int x1, int y1, int x2, int y2)\r\n{\r\n\t//閿熻妭鍖℃嫹閿熷彨纰夋嫹閿熸枻鎷烽敓鏂ゆ嫹铓嶇シ閿??1\r\n\tif(MouseX > x1 \r\n\t&&MouseX < x2\r\n\t&&MouseY > y1\r\n\t&&MouseY < y2\r\n\t&&press == 1)\r\n\t{\r\n\t\treturn 1;\r\n\t}\r\n\t\r\n\t//閿熻妭鍖℃嫹閿熸枻鎷锋湭閿熸枻鎷烽敓鏂ゆ嫹閿熸枻鎷疯殟绁烽敓?2\r\n\telse if(MouseX > x1 \r\n\t&&MouseX < x2\r\n\t&&MouseY > y1\r\n\t&&MouseY < y2\r\n\t&&press == 0)\r\n\t{\r\n\t\treturn 2;\r\n\t}\r\n\t\r\n\t//閿熻妭鍖℃嫹閿熷彨纰夋嫹閿熸枻鎷峰９閿熸枻鎷烽敓鏂ゆ嫹铓嶇シ閿??3\r\n\telse if(MouseX > x1 \r\n\t&&MouseX < x2\r\n\t&&MouseY > y1\r\n\t&&MouseY < y2\r\n\t&&press == 2)\r\n\t{\r\n\t\treturn 3;\r\n\t}\r\n\t\r\n\telse\r\n\t{\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\n"
        }
    ]
}